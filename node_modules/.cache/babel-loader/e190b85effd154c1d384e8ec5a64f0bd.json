{"ast":null,"code":"import _slicedToArray from \"/Users/brendacustodio/Documents/Facul/tcc/atendimento/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/brendacustodio/Documents/Facul/tcc/atendimento/src/pages/ChatPage.js\";\nimport React, { useState, useEffect } from 'react';\nimport socket from 'socket.io-client';\nimport logo from '../assets/img/Logos.png';\nimport api from '../services/api';\nimport moment from 'moment-timezone';\nexport default function ChatPage({\n  match\n}) {\n  const _useState = useState([]),\n        _useState2 = _slicedToArray(_useState, 2),\n        mensagens = _useState2[0],\n        setMensagens = _useState2[1];\n\n  const _useState3 = useState(''),\n        _useState4 = _slicedToArray(_useState3, 2),\n        mensagem = _useState4[0],\n        setMensagem = _useState4[1];\n\n  window.onload = () => {\n    document.getElementById('chat').scrollTop = document.getElementById('chat').scrollHeight;\n  };\n\n  useEffect(() => {\n    async function loadMensagens() {\n      const response = await api.get(\"/getChat?ra=\".concat(match.params.ra));\n      console.log(response.data);\n      setMensagens(response.data);\n    }\n\n    window.scrollTo({\n      top: document.getElementById('chat').scrollHeight\n    });\n    loadMensagens();\n  });\n\n  async function handleSubmit(event) {\n    const io = socket('http://localhost:5000');\n    event.preventDefault();\n    io.emit('add-message', {\n      text: mensagem,\n      origem: 'atendimento',\n      ra: match.params.ra,\n      data: moment(new Date()).tz('America/Sao_Paulo').format('DD-MM-YYYY HH:mm:ss')\n    });\n  }\n\n  return React.createElement(React.Fragment, null, React.createElement(\"div\", {\n    className: \"main-container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45\n    },\n    __self: this\n  }, React.createElement(\"img\", {\n    src: logo,\n    alt: \"\",\n    height: \"100\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 46\n    },\n    __self: this\n  }), React.createElement(\"a\", {\n    href: \"/\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47\n    },\n    __self: this\n  }, \"Voltar para a tela inicial\"), React.createElement(\"div\", {\n    id: \"chat\",\n    className: \"chat\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49\n    },\n    __self: this\n  }, mensagens.map(msg => React.createElement(\"div\", {\n    className: \"balao \".concat(msg.origem != 'aluno' ? 'balao-right' : null),\n    key: msg.data,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    className: \"ra\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52\n    },\n    __self: this\n  }, msg.origem == 'aluno' ? match.params.ra : 'Atendimento'), React.createElement(\"span\", {\n    className: \"msg\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53\n    },\n    __self: this\n  }, msg.text), React.createElement(\"span\", {\n    className: \"data\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54\n    },\n    __self: this\n  }, msg.data)))), React.createElement(\"form\", {\n    onSubmit: handleSubmit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"send\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60\n    },\n    __self: this\n  }, React.createElement(\"input\", {\n    type: \"text\",\n    value: mensagem,\n    onChange: e => setMensagem(e.target.value),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61\n    },\n    __self: this\n  }), React.createElement(\"button\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66\n    },\n    __self: this\n  }, \"Enviar\")))));\n}","map":{"version":3,"sources":["/Users/brendacustodio/Documents/Facul/tcc/atendimento/src/pages/ChatPage.js"],"names":["React","useState","useEffect","socket","logo","api","moment","ChatPage","match","mensagens","setMensagens","mensagem","setMensagem","window","onload","document","getElementById","scrollTop","scrollHeight","loadMensagens","response","get","params","ra","console","log","data","scrollTo","top","handleSubmit","event","io","preventDefault","emit","text","origem","Date","tz","format","map","msg","e","target","value"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\n\nimport socket from 'socket.io-client'\nimport logo from '../assets/img/Logos.png'\nimport api from '../services/api'\nimport moment from 'moment-timezone'\n\nexport default function ChatPage({ match }) {\n    const [mensagens, setMensagens] = useState([])\n    const [mensagem, setMensagem] = useState('')\n\n    window.onload = () => {\n        document.getElementById('chat').scrollTop = document.getElementById('chat').scrollHeight\n    }\n\n    useEffect(() => {\n        async function loadMensagens() {\n            const response = await api.get(`/getChat?ra=${match.params.ra}`)\n            console.log(response.data)\n            setMensagens(response.data)\n        }\n\n        window.scrollTo({\n            top: document.getElementById('chat').scrollHeight\n        })\n\n        loadMensagens()\n    })\n    \n    async function handleSubmit(event) {\n        const io = socket('http://localhost:5000')\n\n        event.preventDefault()\n        \n        io.emit('add-message', { \n            text: mensagem, \n            origem: 'atendimento',\n            ra: match.params.ra,\n            data: moment(new Date()).tz('America/Sao_Paulo').format('DD-MM-YYYY HH:mm:ss')\n        })\n    }\n\n    return (\n        <>\n            <div className=\"main-container\">\n                <img src={logo} alt=\"\" height=\"100\" />\n                <a href=\"/\">Voltar para a tela inicial</a>\n\n                <div id=\"chat\" className=\"chat\">\n                    {mensagens.map(msg => (\n                        <div className={`balao ${msg.origem != 'aluno' ? 'balao-right' : null}`} key={msg.data}>\n                            <span className=\"ra\">{msg.origem == 'aluno' ? match.params.ra : 'Atendimento'}</span>\n                            <span className=\"msg\">{msg.text}</span>\n                            <span className=\"data\">{msg.data}</span>\n                        </div>\n                    ))}\n                </div>\n\n                <form onSubmit={handleSubmit}>\n                    <div className=\"send\">\n                        <input \n                            type=\"text\"\n                            value={mensagem}\n                            onChange={e => setMensagem(e.target.value)}\n                        />\n                        <button>Enviar</button>\n                    </div>\n                </form>\n\n            </div>\n        </>\n    )\n}"]},"metadata":{},"sourceType":"module"}